/**
 * Official Type definitions for JSS Formula Premium
 * https://jspreadsheet.com/products/client
 */

declare function client(options: client.Options) : Array<client.Instance>;

declare namespace client {

    interface Options {
        url?: string;
        path?: string;
        token?: string;
        onbeforeload?: (url: string) => string;
        onbeforecreate?: (result: object) => void;
        onbeforeloadimage?: (worksheet: object, img: HTMLImageElement, options: object) => boolean | void;
    }

    interface Instance {
        create: (guid: string, config: object) => Promise<object>;
        destroy: (guid: string, callback: Function) => void;
        disconnect: () => void;
        getSocket: () => object;
    }

    function getServerUrl() : string;
    function getServerPath() : string;
    function connect(options: Options) : Instance
}

export default client;